import { createClient } from '@supabase/supabase-js';
import dotenv from 'dotenv';
import path from 'path';
import { fileURLToPath } from 'url';

const __filename = fileURLToPath(import.meta.url);
const __dirname = path.dirname(__filename);

dotenv.config({ path: path.resolve(__dirname, '../.env.local') });

const SUPABASE_URL = process.env.NEXT_PUBLIC_SUPABASE_URL;
const SUPABASE_SERVICE_KEY = process.env.SUPABASE_SERVICE_ROLE_KEY || process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;

const supabase = createClient(SUPABASE_URL, SUPABASE_SERVICE_KEY);

const data = [{ "workspace_id": "54cce5b0-ce26-4d59-8937-38cc4a1e440c", "platform": "linkedin", "platform_user_id": "09Uv5wIaSFOiN2gru_svbA", "platform_username": null, "platform_display_name": "Thorsten Linz", "profile_url": null, "profile_image_url": null, "account_type": "personal", "integration_provider": "unipile", "integration_account_id": "09Uv5wIaSFOiN2gru_svbA", "status": "active", "owner_name": "Thorsten", "owner_email": "thorsten@innovare.ai" }, { "workspace_id": "54cce5b0-ce26-4d59-8937-38cc4a1e440c", "platform": "linkedin", "platform_user_id": "1Z6FD609R-OMVSaS5Xv5fA", "platform_username": null, "platform_display_name": "Cindy Mae Baluyot", "profile_url": null, "profile_image_url": null, "account_type": "personal", "integration_provider": "unipile", "integration_account_id": "1Z6FD609R-OMVSaS5Xv5fA", "status": "active", "owner_name": "Cindy", "owner_email": "cindy@innovare.ai" }, { "workspace_id": "54cce5b0-ce26-4d59-8937-38cc4a1e440c", "platform": "linkedin", "platform_user_id": "4H2XP5VTQPKbYvXyfE-ItA", "platform_username": null, "platform_display_name": "Dr. Stephanie Gripne", "profile_url": null, "profile_image_url": null, "account_type": "personal", "integration_provider": "unipile", "integration_account_id": "4H2XP5VTQPKbYvXyfE-ItA", "status": "active", "owner_name": "Dr. Stephanie Gripne", "owner_email": null }, { "workspace_id": "54cce5b0-ce26-4d59-8937-38cc4a1e440c", "platform": "linkedin", "platform_user_id": "4nt1J-blSnGUPBjH2Nfjpg", "platform_username": null, "platform_display_name": "ùóñùóµùóÆùóøùó∂ùòÄùòÄùóÆ ùó¶ùóÆùóªùó∂ùó≤ùóπ", "profile_url": null, "profile_image_url": null, "account_type": "personal", "integration_provider": "unipile", "integration_account_id": "4nt1J-blSnGUPBjH2Nfjpg", "status": "active", "owner_name": "ùóñùóµùóÆùóøùó∂ùòÄùòÄùóÆ ùó¶ùóÆùóªùó∂ùó≤ùóπ", "owner_email": null }, { "workspace_id": "54cce5b0-ce26-4d59-8937-38cc4a1e440c", "platform": "linkedin", "platform_user_id": "H4xvg9rGTRmAtDA7waAfwA", "platform_username": null, "platform_display_name": "Patricia Lamberte ", "profile_url": null, "profile_image_url": null, "account_type": "personal", "integration_provider": "unipile", "integration_account_id": "H4xvg9rGTRmAtDA7waAfwA", "status": "active", "owner_name": "Patricia", "owner_email": "patricia@innovare.ai" }, { "workspace_id": "54cce5b0-ce26-4d59-8937-38cc4a1e440c", "platform": "linkedin", "platform_user_id": "Ll1T0gRVTYmLM6kqN1cJcg", "platform_username": null, "platform_display_name": "ChonaM Lamberte", "profile_url": null, "profile_image_url": null, "account_type": "personal", "integration_provider": "unipile", "integration_account_id": "Ll1T0gRVTYmLM6kqN1cJcg", "status": "active", "owner_name": "Chona", "owner_email": "chona@innovare.ai" }, { "workspace_id": "54cce5b0-ce26-4d59-8937-38cc4a1e440c", "platform": "linkedin", "platform_user_id": "RFrEaJZOSGieognCTW0V6w", "platform_username": null, "platform_display_name": "Brian Neirby", "profile_url": null, "profile_image_url": null, "account_type": "personal", "integration_provider": "unipile", "integration_account_id": "RFrEaJZOSGieognCTW0V6w", "status": "active", "owner_name": "Brian Neirby", "owner_email": null }, { "workspace_id": "54cce5b0-ce26-4d59-8937-38cc4a1e440c", "platform": "linkedin", "platform_user_id": "_R2kzcUURzeCOig2U8ZVGA", "platform_username": null, "platform_display_name": "Vincent Handugan", "profile_url": null, "profile_image_url": null, "account_type": "personal", "integration_provider": "unipile", "integration_account_id": "_R2kzcUURzeCOig2U8ZVGA", "status": "active", "owner_name": "Vincent", "owner_email": "vincent@innovare.ai" }, { "workspace_id": "54cce5b0-ce26-4d59-8937-38cc4a1e440c", "platform": "linkedin", "platform_user_id": "aroiwOeQQo2S8_-FqLjzNw", "platform_username": null, "platform_display_name": "Michelle Angelica  Gestuveo ", "profile_url": null, "profile_image_url": null, "account_type": "personal", "integration_provider": "unipile", "integration_account_id": "aroiwOeQQo2S8_-FqLjzNw", "status": "active", "owner_name": "Michelle", "owner_email": "michelle@innovare.ai" }, { "workspace_id": "54cce5b0-ce26-4d59-8937-38cc4a1e440c", "platform": "linkedin", "platform_user_id": "fntPg3vJTZ2Z1MP4rISntg", "platform_username": null, "platform_display_name": "Samantha Truman", "profile_url": null, "profile_image_url": null, "account_type": "personal", "integration_provider": "unipile", "integration_account_id": "fntPg3vJTZ2Z1MP4rISntg", "status": "active", "owner_name": "Samantha Truman", "owner_email": null }, { "workspace_id": "54cce5b0-ce26-4d59-8937-38cc4a1e440c", "platform": "linkedin", "platform_user_id": "gW6mCsj7RK-vp89UcDUC2w", "platform_username": null, "platform_display_name": "Sebastian Henkel", "profile_url": null, "profile_image_url": null, "account_type": "personal", "integration_provider": "unipile", "integration_account_id": "gW6mCsj7RK-vp89UcDUC2w", "status": "active", "owner_name": "Sebastian Henkel", "owner_email": null }, { "workspace_id": "54cce5b0-ce26-4d59-8937-38cc4a1e440c", "platform": "linkedin", "platform_user_id": "haSQAeSxRLClUAATodWvQA", "platform_username": null, "platform_display_name": "John Sechrest", "profile_url": null, "profile_image_url": null, "account_type": "personal", "integration_provider": "unipile", "integration_account_id": "haSQAeSxRLClUAATodWvQA", "status": "active", "owner_name": "John Sechrest", "owner_email": null }, { "workspace_id": "54cce5b0-ce26-4d59-8937-38cc4a1e440c", "platform": "linkedin", "platform_user_id": "k0EXUNT0RGOMNOGm86KopQ", "platform_username": null, "platform_display_name": "Noriko Yokoi, Ph.D.", "profile_url": null, "profile_image_url": null, "account_type": "personal", "integration_provider": "unipile", "integration_account_id": "k0EXUNT0RGOMNOGm86KopQ", "status": "active", "owner_name": "Noriko Yokoi, Ph.D.", "owner_email": null }, { "workspace_id": "54cce5b0-ce26-4d59-8937-38cc4a1e440c", "platform": "linkedin", "platform_user_id": "mVeMlrumQlmzb-xS81BY3A", "platform_username": null, "platform_display_name": "Alekh Jindal", "profile_url": null, "profile_image_url": null, "account_type": "personal", "integration_provider": "unipile", "integration_account_id": "mVeMlrumQlmzb-xS81BY3A", "status": "active", "owner_name": "Alekh Jindal", "owner_email": null }, { "workspace_id": "54cce5b0-ce26-4d59-8937-38cc4a1e440c", "platform": "linkedin", "platform_user_id": "nGqBWgDmTkqnoMGA3Hbc9w", "platform_username": null, "platform_display_name": "Stan Bounev", "profile_url": null, "profile_image_url": null, "account_type": "personal", "integration_provider": "unipile", "integration_account_id": "nGqBWgDmTkqnoMGA3Hbc9w", "status": "active", "owner_name": "Stan Bounev", "owner_email": null }, { "workspace_id": "54cce5b0-ce26-4d59-8937-38cc4a1e440c", "platform": "linkedin", "platform_user_id": "ra45C3YbQmC7w1IoPcQsag", "platform_username": null, "platform_display_name": "Tobias Linz", "profile_url": null, "profile_image_url": null, "account_type": "personal", "integration_provider": "unipile", "integration_account_id": "ra45C3YbQmC7w1IoPcQsag", "status": "active", "owner_name": "Tobias", "owner_email": "tobias@innovare.ai" }];

async function run() {
    for (const item of data) {
        const { error } = await supabase
            .from('vera_connected_accounts')
            .upsert(item, { onConflict: 'workspace_id,platform,platform_user_id' });

        if (error) {
            console.error(`Error upserting ${item.platform_display_name}:`, error.message);
        } else {
            console.log(`Upserted ${item.platform_display_name}`);
        }
    }
}

run();
